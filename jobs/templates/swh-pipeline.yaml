- job-template:
    name: "{name}/tests"
    display-name: "master branch"
    project-type: pipeline
    docker_image: tox
    default-tox-environment: py3
    triggers:
      - timed: '@daily'
    sandbox: true
    auth-token: 'ph4br1cat0r'
    properties:
      - build-discarder:
          num-to-keep: 20
    parameters:
      - git-parameter:
          name: REVISION
          type: PT_REVISION
          defaultValue: master
          description: Git revision to build.
      - string:
          name: PHID
          description: PHID of the Phabricator target object on which results will be reported.
      - string:
          name: TOX_ENVIRONMENT
          description: tox environment to use for the main tox run
          default: "{default-tox-environment}"

    dsl:
      !include-jinja2: swh-pipeline.groovy.j2

