- job-template: &automatic_backport
    name: 'debian/packages/{name}/automatic-backport'
    description: |
      Backport Debian package to the given release
    project-type: pipeline
    parameters:
      - git-parameter:
          name: GIT_TAG
          description: git tag to backport
          type: PT_TAG
          sortMode: DESCENDING_SMART
          selectedValue: TOP
          tagFilter: debian/.*
      - choice:
          name: SOURCE
          description: check that the source branch corresponds to this before issuing the backport
          choices:
            - unstable-swh
            - unstable
            - bookworm-swh
            - bullseye-swh
            - buster-swh
            - stretch-swh
          default: unstable-swh
      - choice:
          name: DESTINATION
          description: the destination branch the backport targets
          choices:
            - stretch-swh
            - buster-swh
            - bullseye-swh
            - bookworm-swh
          default: buster-swh
      - bool:
          name: DRY_RUN
          description: Don't push the resulting changes to a Debian branch
          default: false
    dsl:
      !include-jinja2: automatic-backport.groovy.j2

- job-template:
    name: 'debian/deps/{name}/automatic-backport'
    <<: *automatic_backport
