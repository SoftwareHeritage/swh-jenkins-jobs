- job-template:
    name: '{name}/tox'
    display-name: 'Phab. Diff (legacy)'
    docker_image: tox
    node: "swh-{docker_image}"
    default-tox-environment: py3
    auth-token: ph4br1cat0r
    parameters:
      - string:
          name: REPO
          description: PHID of the Diffusion repository
      - string:
          name: PHID
          description: PHID of the Target object
      - string:
          name: DIFF_ID
          description: ID of the Diff patch to apply, if any
      - string:
          name: TOX_ENVIRONMENT
          description: tox environment to use for the main tox run
          default: "{default-tox-environment}"
    scm:
      - git:
          url: https://forge.softwareheritage.org/source/{repo_name}.git
          branches:
            - origin/master

    builders:
      - shell: |
          echo "This job is only kept for historical purposes; please run {name}/tests-on-diff instead"
          return 1
